系统架构的设计开始于数据类的设计。以下是数据类的设计。首先，我们设计了8个数据类代表实体，分别是Admin(管理员相关数据)、Building(包括地址在内的建筑数据)、Map(包括地图轮廓和镂空的地图底图)、Facility(包括位置在内的设备数据)、Storearea(包括形状在内的商店区域数据)、Eventarea(包括形状在内的活动区域数据)、Otherarea(包括形状在内的其他区域数据)、Event(该商场举办的活动相关的数据)。接着，我们设计了6个联系类表示实体之间的联系，每个联系类都联系了两个实体类，分别是EventEventarea(表示活动与活动区域之间的联系)、EventStorearea(表示活动与商店区域之间的联系)、EventareaMap(表示活动区域和地图之间的联系)、StoreareaMap(表示商店区域和地图之间的联系)、OtherareaMap(表示其他区域和地图的联系)。此外，地图和建筑之间通过外键联系。

 

![img](file:///C:\Users\黄彦炜\AppData\Local\Temp\ksohtml26692\wps1.jpg) 

 

前面两行是实体，最后一行是联系

 

在设计了数据类之后，我们进行系统架构设计中的包图的设计。首先，最底层为数据持久层，我们采用带有PostGIS扩展的PostgreSQL数据库。接着，中间层为后端，业务逻辑层。该层使用的语言为python，使用的框架为带有RESTful Framework扩展的Django框架。具体来说，后端可再细为7个包，分别是core(采用对象关系映射ORM实现之前设计的数据类)、management (实现管理员的登录注册以及通过简单填表就能修改信息的逻辑)、map(返回包括地图轮廓、镂空、3种区域、设备在内的整个地图的信息)、guide(实现基于A*算法的路线规划功能)、editor(实现对地图上包括3种区域和设备在内的元素的形状位置的修改)、search(根据游客不同的搜索要求，实现按条件返回包括活动和3种区域在内的特定信息)、python_backend(包括统一资源定位符URL在内的各种后端配置)。最后，最上层为前端，用户界面层。该层分为2个包，分别是基于微信小程序实现的游客端、基于Vue3框架实现的Web管理端。

 

其中，后端的这4个包management、map、editor、search都可以再细分为4个构件，分别是context(直接对数据库进行操作的数据库上下文构件)、service(实现复杂业务逻辑的构件)、serializer(基于数据类的字段，自定义返回字段格式的序列化器)、views(直接接收前端HTTP请求，组织并调用复杂业务逻辑，返回JSON格式数据给前端的Web API)。Guide包因为不涉及与数据类相关的字段返回，所以没有serializer构件，只有context、service、views构件。

 

 

 

![img](file:///C:\Users\黄彦炜\AppData\Local\Temp\ksohtml26692\wps2.jpg) 