## 接口文档

- **后端技术栈**: Django + Django REST framework  
- **统一前缀**: 所有对外 REST 接口目前统一前缀为 `/api/`  

---

## 一、接口（已实现）

当前已经在 `python_backend.urls` 中挂载的对外接口为 `/api/search/` 下的一组搜索与查询接口，对应前端 `src/api/search.js`。

### 1. 店铺区域 Storearea 接口

**URL 前缀**：`/api/search/storearea/`

| 接口名称 | URL | 方法 | 请求参数 | 返回数据 | 说明 |
|---------|-----|------|----------|----------|------|
| 获取店铺区域详情 | `/api/search/storearea/{storearea_id}/` | GET | 路径参数：`storearea_id` (int) | 单个店铺区域对象 | 根据 ID 获取商铺区域完整信息 |
| 按名称搜索店铺区域 | `/api/search/storearea/search/` | GET | Query：`name` (string，模糊匹配) | 店铺区域对象数组 | 按名称模糊搜索店铺区域 |
| 按类型列出店铺区域 | `/api/search/storearea/list/` | GET | Query：`type` (int，可空) | - 若传 `type`：`{ type, storeareas: [...] }`<br> - 若不传：`{ [type]: [简化店铺对象数组], ... }` | 按类型获取店铺区域列表，未传 type 时按类型分组返回简化信息 |
| 查询店铺区域关联活动 | `/api/search/storearea/{storearea_id}/events/` | GET | 路径参数：`storearea_id` (int) | 活动 ID 数组（int 列表） | 获取某店铺区域下参与的所有活动 ID |
| 查询店铺区域所在地图 | `/api/search/storearea/{storearea_id}/map/` | GET | 路径参数：`storearea_id` (int) | `map_id` 或 `map_id` 数组 | 获取该店铺区域所在地图标识 |
| 按地图与类型查店铺区域 ID | `/api/search/storearea/list/map/` | GET | Query：`map_id` (int/string), `type` (int，可空) | 店铺区域 ID 数组 | 在指定地图下、指定类型的店铺区域 ID 列表 |
| 按地图查询所有店铺区域 ID | `/api/search/storearea/list/all_by_map/` | GET | Query：`map_id` (int/string) | 店铺区域 ID 数组 | 在指定地图下的全部店铺区域 ID 列表 |

---

### 2. 活动 Event 接口

**URL 前缀**：`/api/search/event/`

| 接口名称 | URL | 方法 | 请求参数 | 返回数据 | 说明 |
|---------|-----|------|----------|----------|------|
| 获取活动详情 | `/api/search/event/{event_id}/` | GET | 路径参数：`event_id` (int) | 单个活动对象 | 根据 ID 获取活动完整信息 |
| 按名称搜索活动 | `/api/search/event/search/` | GET | Query：`name` (string，模糊匹配) | 活动对象数组 | 按名称模糊搜索活动 |
| 按类型列出活动 | `/api/search/event/list/` | GET | Query：`type` (int，可空) | - 若传 `type`：`{ type, events: [...] }`<br> - 若不传：`{ [type]: [简化活动对象数组], ... }` | 按类型获取活动列表，支持按活动区域类型聚合 |
| 查询活动关联区域 | `/api/search/event/{event_id}/areas/` | GET | 路径参数：`event_id` (int) | 区域 ID 数组 | 获取参加该活动的所有区域 ID |

---

### 3. 活动区域 Eventarea 接口

**URL 前缀**：`/api/search/eventarea/`

| 接口名称 | URL | 方法 | 请求参数 | 返回数据 | 说明 |
|---------|-----|------|----------|----------|------|
| 获取活动区域详情 | `/api/search/eventarea/{eventarea_id}/` | GET | 路径参数：`eventarea_id` (int) | 单个活动区域对象 | 根据 ID 获取活动区域完整信息 |
| 按地图与类型查活动区域 ID | `/api/search/eventarea/list/ids_by_map_type/` | GET | Query：`map_id` (int/string), `type` (int，可空) | 活动区域 ID 数组 | 在指定地图下、指定类型的活动区域 ID 列表 |
| 查询活动区域所在地图 | `/api/search/eventarea/{eventarea_id}/map/` | GET | 路径参数：`eventarea_id` (int) | `map_id` 或 `map_id` 数组 | 获取该活动区域所在地图标识 |
| 按地图查询所有活动区域 ID | `/api/search/eventarea/list/all_by_map/` | GET | Query：`map_id` (int/string) | 活动区域 ID 数组 | 指定地图下的全部活动区域 ID 列表 |

---

### 4. 设施 Facility 接口

**URL 前缀**：`/api/search/facility/`

| 接口名称 | URL | 方法 | 请求参数 | 返回数据 | 说明 |
|---------|-----|------|----------|----------|------|
| 获取设施详情 | `/api/search/facility/{facility_id}/` | GET | 路径参数：`facility_id` (int) | 单个设施对象 | 根据 ID 获取设施完整信息 |
| 按地图与类型查设施 ID | `/api/search/facility/list/ids_by_map_type/` | GET | Query：`map_id` (int/string), `type` (int，可空) | 设施 ID 数组 | 在指定地图下、指定类型的设施 ID 列表 |
| 查询设施所在地图 | `/api/search/facility/{facility_id}/map/` | GET | 路径参数：`facility_id` (int) | `map_id` 或 `map_id` 数组 | 获取该设施所在地图标识 |
| 按地图查询所有设施 ID | `/api/search/facility/list/all_by_map/` | GET | Query：`map_id` (int/string) | 设施 ID 数组 | 指定地图下全部设施 ID 列表 |

---

### 5. 其他区域 Otherarea 接口

**URL 前缀**：`/api/search/otherarea/`

| 接口名称 | URL | 方法 | 请求参数 | 返回数据 | 说明 |
|---------|-----|------|----------|----------|------|
| 获取其他区域详情 | `/api/search/otherarea/{otherarea_id}/` | GET | 路径参数：`otherarea_id` (int) | 单个其他区域对象 | 获取“其他类型”区域详细信息 |
| 按地图与类型查其他区域 ID | `/api/search/otherarea/list/ids_by_map_type/` | GET | Query：`map_id` (int/string), `type` (int，可空) | 区域 ID 数组 | 指定地图与类型下的其他区域 ID 列表 |
| 查询其他区域所在地图 | `/api/search/otherarea/{otherarea_id}/map/` | GET | 路径参数：`otherarea_id` (int) | `map_id` 或 `map_id` 数组 | 获取该区域所在地图标识 |
| 按地图查询所有其他区域 ID | `/api/search/otherarea/list/all_by_map/` | GET | Query：`map_id` (int/string) | 区域 ID 数组 | 指定地图下全部其他区域 ID 列表 |

---

## 二、接口设计（部分未实现）

本节用于规划系统内部使用的 HTTP 接口（如：后台管理、地图配置、导览策略、内容编辑等）。**目前大部分尚未在后端实现，仅在文档中预留位置，方便后续补充实现与说明。**

下面表格中，标记为“未实现”的接口暂时不存在于后端代码中，仅作为设计占位；后续实现时可在此文档中补充「请求参数」「返回数据」「说明」等详细信息。

### 1. 核心业务 Core 模块（占位）

**建议前缀**：`/api/core/`

| 接口名称 | URL（建议） | 方法 | 状态 | 请求参数 | 返回数据 | 说明 |
|---------|-------------|------|------|----------|----------|------|
| 获取项目基础配置 | `/api/core/config/` | GET | 未实现 | - | - | 预留：系统级基础配置（营业时间、默认地图等） |
| 获取用户角色与权限 | `/api/core/users/{user_id}/roles/` | GET | 未实现 | - | - | 预留：内部权限控制及管理界面使用 |
| 批量导入店铺／活动数据 | `/api/core/import/` | POST | 未实现 | - | - | 预留：Excel/CSV/接口同步导入基础数据 |

### 2. 地图 Map 模块（占位）

**建议前缀**：`/api/map/`

| 接口名称 | URL（建议） | 方法 | 状态 | 请求参数 | 返回数据 | 说明 |
|---------|-------------|------|------|----------|----------|------|
| 获取地图列表 | `/api/map/list/` | GET | 未实现 | - | - | 预留：获取所有可用地图（楼层/场馆）列表 |
| 获取单张地图详情 | `/api/map/{map_id}/` | GET | 未实现 | - | - | 预留：返回地图基础信息（名称、楼层、尺寸等） |
| 更新地图基础信息 | `/api/map/{map_id}/` | PUT | 未实现 | - | - | 预留：后台编辑地图属性 |
| 获取地图上的区域布局 | `/api/map/{map_id}/layout/` | GET | 未实现 | - | - | 预留：返回地图上各区域（店铺/活动/设施等）的布局信息 |

### 3. 导览 Guide 模块（占位）

**建议前缀**：`/api/guide/`

| 接口名称 | URL（建议） | 方法 | 状态 | 请求参数 | 返回数据 | 说明 |
|---------|-------------|------|------|----------|----------|------|
| 路线规划 | `/api/guide/route/` | GET | 未实现 | - | - | 预留：根据起点/终点计算馆内最优路线 |
| 推荐路线列表 | `/api/guide/recommendations/` | GET | 未实现 | - | - | 预留：返回推荐路线（亲子路线、美食路线等） |
| 保存自定义路线 | `/api/guide/routes/` | POST | 未实现 | - | - | 预留：用户自定义路线保存接口 |

### 4. 管理后台 Management 模块（占位）

**建议前缀**：`/api/management/`

| 接口名称 | URL（建议） | 方法 | 状态 | 请求参数 | 返回数据 | 说明 |
|---------|-------------|------|------|----------|----------|------|
| 店铺管理-列表 | `/api/management/storeareas/` | GET | 未实现 | - | - | 预留：后台分页查看店铺区域 |
| 店铺管理-创建 | `/api/management/storeareas/` | POST | 未实现 | - | - | 预留：创建新店铺区域 |
| 店铺管理-更新 | `/api/management/storeareas/{storearea_id}/` | PUT/PATCH | 未实现 | - | - | 预留：编辑店铺区域信息 |
| 店铺管理-删除 | `/api/management/storeareas/{storearea_id}/` | DELETE | 未实现 | - | - | 预留：删除店铺区域 |
| 活动管理-列表 | `/api/management/events/` | GET | 未实现 | - | - | 预留：后台分页查看活动 |
| 活动管理-创建/更新/删除 | `/api/management/events/...` | 多种 | 未实现 | - | - | 预留：活动生命周期管理接口组 |

### 5. 编辑 Editor 模块（占位）

**建议前缀**：`/api/editor/`

| 接口名称 | URL（建议） | 方法 | 状态 | 请求参数 | 返回数据 | 说明 |
|---------|-------------|------|------|----------|----------|------|
| 获取编辑草稿 | `/api/editor/drafts/{id}/` | GET | 未实现 | - | - | 预留：地图或内容编辑草稿读取 |
| 保存编辑草稿 | `/api/editor/drafts/` | POST | 未实现 | - | - | 预留：保存草稿（未发布） |
| 发布编辑结果 | `/api/editor/publish/` | POST | 未实现 | - | - | 预留：将草稿应用到正式数据 |

---

## 三、接口使用约定

- **认证与权限**：当前 `REST_FRAMEWORK` 默认权限为 `AllowAny`，即所有接口对外开放；后续可按模块逐步收紧为需要登录或特定角色。
- **返回格式**：  
  - 成功：通常返回 JSON 对象或数组，结构由对应的 Serializer 决定。  
  - 失败：统一返回 `{ "detail": "错误信息" }` 或类似结构，并附带适当的 HTTP 状态码（如 400 / 404 / 500 等）。  
- **分页**：  
  - 全局配置了分页，但当前列出的搜索接口多为列表直接返回，后续若需要分页，可在对应接口上启用分页并在文档中补充。  

